<div class="row">

    <div class="col-lg-12">
        <form [formGroup]="accountsForm" (ngSubmit)="addDetail()">
            <mat-card class="cardWithShadow">
                <mat-card-header>
                    <div class="col-md-12 p-24">
                        <mat-card-title>Accounts
                            <button type="submit" mat-fab extended class="float-right m-b-20">
                                <mat-icon>upload</mat-icon> Save
                            </button>
                        </mat-card-title>
                    </div>
                </mat-card-header>
                <mat-card-content>
                    <div class="col-md-12 d-flex">
                        <div class="col-md-4">
                            <div class="input_group">
                                <mat-form-field appearance="outline" class="w-100" color="primary">
                                    <mat-label class="mat-subtitle-2 f-s-14 f-w-600 m-b-12 d-block">Tour</mat-label>
                                    <mat-select formControlName="tour_id" (selectionChange)="loadMembers()">
                                        <mat-option *ngFor="let tour of tours" [value]="tour._id">
                                            {{tour.plan}}
                                        </mat-option>
                                    </mat-select>
                                    <mat-error class="error"
                                        *ngIf="af.tour_id.errors?.['required'] && (accountsFormSubmitted)">
                                        Choose the Tour
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="input_group">
                                <mat-radio-group aria-label="Select an option" formControlName="type" (change)="transactionTypeChange()">
                                    <mat-radio-button value="collection">Collection</mat-radio-button>
                                    <mat-radio-button value="expenditure">Expenditure</mat-radio-button>
                                </mat-radio-group>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="af.tour_id.value">
                        <div>
                            <div class="col-md-12 p-24">
                                <mat-card-title> {{ af.type.value == 'collection' ? 'Collection': 'Expenditure'
                                    }}</mat-card-title>
                            </div>
                            <div class="col-md-12">
                                <div class="row m-l-0 m-r-0">
                                    <div class="col-md-4 m-b-10">
                                        <div class="input_group">
                                            <mat-form-field appearance="outline" class="w-100" color="primary">
                                                <mat-label class="mat-subtitle-2 f-s-14 f-w-600 m-b-12 d-block">
                                                    Date</mat-label>
                                                <input matInput [matDatepicker]="picker" formControlName="date">
                                                <mat-datepicker-toggle matIconSuffix
                                                    [for]="picker"></mat-datepicker-toggle>
                                                <mat-datepicker #picker></mat-datepicker>
                                                <mat-error class="error"
                                                    *ngIf="af.date.errors?.['required'] && (accountsFormSubmitted)">
                                                    Date Can't be empty
                                                </mat-error>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="col-md-4 m-b-10" *ngIf="af.type.value == 'collection'">
                                        <div class="input_group">
                                            <mat-form-field appearance="outline" class="w-100" color="primary">
                                                <mat-label class="mat-subtitle-2 f-s-14 f-w-600 m-b-12 d-block">
                                                    Collected
                                                    From</mat-label>
                                                <mat-select formControlName="collected_from"
                                                    (selectionChange)="selectMember($event.value, true)">
                                                    <mat-option *ngFor="let member of members" [value]="member._id">
                                                        {{member.name}}
                                                    </mat-option>
                                                </mat-select>
                                                <mat-error class="error"
                                                    *ngIf="af.collected_from.errors?.['required'] && (accountsFormSubmitted)">
                                                    Choose the Member
                                                </mat-error>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="col-md-4 m-b-10">
                                        <div class="input_group">
                                            <mat-form-field appearance="outline" class="w-100" color="primary">
                                                <mat-label class="mat-subtitle-2 f-s-14 f-w-600 m-b-12 d-block">{{
                                                    af.type.value == 'collection' ? 'Collection': 'Expense'
                                                    }}
                                                    Amount</mat-label>
                                                <input matInput type="number" formControlName="amount" maxlength="25" />
                                                <mat-error class="error"
                                                    *ngIf="af.amount.errors?.['required'] && (accountsFormSubmitted)">
                                                    Amount can't be empty
                                                </mat-error>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="col-md-4 m-b-10">
                                        <div class="input_group">
                                            <mat-form-field appearance="outline" class="w-100" color="primary">
                                                <mat-label class="mat-subtitle-2 f-s-14 f-w-600 m-b-12 d-block">{{
                                                    af.type.value == 'collection' ? 'Collected': 'Spent'
                                                    }}
                                                    For</mat-label>
                                                <input matInput type="text" formControlName="reason" maxlength="255" />
                                                <mat-error class="error"
                                                    *ngIf="af.reason.errors?.['required'] && (accountsFormSubmitted)">
                                                    Reason can't be empty
                                                </mat-error>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 p-24">
                            <mat-card-title> Split {{ (af.type.value == 'collection' ? 'Collection': 'Expense'
                                )}}</mat-card-title>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-3">
                                    <mat-checkbox (change)="selectAll($event.checked)" [checked]="isAllSelected">
                                        <span class="f-w-600">All Members</span>
                                    </mat-checkbox>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-3" *ngFor="let member of members">
                                    <mat-checkbox [value]="member._id" [checked]="member.checked"
                                        (change)="selectMember($event.source.value, $event.checked)">
                                        <span class="f-w-500"><i> {{member.name | titlecase}}</i></span>
                                    </mat-checkbox>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row m-r-0 m-l-0">
                                <div class="col-md-12 m-auto">
                                    <mat-error class="error"
                                        *ngIf="selectedMembers.length === 0  && (accountsFormSubmitted)">
                                        Atleast one member should be selected
                                    </mat-error>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-card-content>
            </mat-card>
        </form>
    </div>
</div>